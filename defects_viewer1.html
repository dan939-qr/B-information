<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì œí’ˆ ë¶ˆëŸ‰ ì •ë³´ ì¡°íšŒ</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 30px;
    }
    img.logo {
      height: 40px;
      margin-bottom: 20px;
    }
    table {
      margin: 20px auto;
      border-collapse: collapse;
    }
    td {
      width: 50px;
      height: 50px;
      border: 1px solid #000;
      font-weight: bold;
      vertical-align: middle;
    }
    .defect {
      background-color: red;
      color: white;
    }
    .info {
      margin-top: 30px;
      font-size: 16px;
    }
    .info span {
      display: block;
      margin: 4px 0;
    }
    .error {
      color: red;
      font-weight: bold;
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <!-- ìƒë‹¨ ë¡œê³  -->
  <img src="hyundai_logo.png" alt="í˜„ëŒ€ L&C ë¡œê³ " class="logo" />
  <h2>ì œí’ˆ ë¶ˆëŸ‰ ìœ„ì¹˜ ë° ì •ë³´</h2>
  <p>ì‹œë¦¬ì–¼ë²ˆí˜¸: <span id="snDisplay">-</span></p>
  <table id="defectTable"></table>

  <div class="info" id="productInfo"></div>
  <div class="error" id="errorMsg"></div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const sn = params.get("sn");
    const labels = [..."ABCDEFGHIJKLMNOPQR"];
    const table = document.getElementById("defectTable");
    const infoBox = document.getElementById("productInfo");
    const errorBox = document.getElementById("errorMsg");

    document.getElementById("snDisplay").textContent = sn || "(ì—†ìŒ)";

    if (!sn || sn.length < 23) {
      errorBox.textContent = "âš  ìœ íš¨í•˜ì§€ ì•Šì€ ì‹œë¦¬ì–¼ë²ˆí˜¸ì…ë‹ˆë‹¤.";
    } else {
      try {
        const productCode = sn.slice(0, 5);
        const date = sn.slice(5, 11);
        const thickness = sn.slice(11, 13);
        const pattern = sn.slice(13, 15);
        const defectType = sn.slice(15, 17);

        // ğŸ”§ ìˆ˜ì •ëœ ë¶€ë¶„: ì‹œë¦¬ì–¼ë²ˆí˜¸ ë ìˆ«ìë§Œ ì •í™•íˆ ì¶”ì¶œ
        const defectMask = parseInt(sn.match(/\d+$/)[0]);

        let idx = 0;
        for (let row = 0; row < 3; row++) {
          const tr = document.createElement("tr");
          for (let col = 0; col < 6; col++) {
            const td = document.createElement("td");
            const label = labels[idx];
            td.textContent = label;
            if ((defectMask & (1 << idx)) !== 0) td.classList.add("defect");
            tr.appendChild(td);
            idx++;
          }
          table.appendChild(tr);
        }

        infoBox.innerHTML = `
          <h3>ì œí’ˆ ì •ë³´</h3>
          <span>ì œí’ˆì½”ë“œ: ${productCode}</span>
          <span>ìƒì‚°ì¼ì: 20${date.slice(0, 2)}-${date.slice(2, 4)}-${date.slice(4, 6)}</span>
          <span>ë‘ê»˜: ${thickness}mm</span>
          <span>íŒ¨í„´/ë“±ê¸‰: ${pattern}</span>
          <span>ë¶ˆëŸ‰ìœ í˜•ì½”ë“œ: ${defectType}</span>
        `;
      } catch (err) {
        errorBox.textContent = "âš  ì‹œë¦¬ì–¼ ì •ë³´ í•´ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
        console.error(err);
      }
    }
  </script>
</body>
</html>
